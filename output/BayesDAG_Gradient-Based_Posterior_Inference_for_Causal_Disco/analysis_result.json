{
  "paper_id": "BayesDAG_Gradient-Based_Posterior_Inference_for_Causal_Disco",
  "title": "BayesDAG: Gradient-Based Posterior Inference for Causal Discovery",
  "abstract": "Bayesian causal discovery aims to infer the posterior distribution over causal models from observed data, quantifying epistemic uncertainty and benefiting downstream tasks. However, computational challenges arise due to joint inference over combinatorial space of Directed Acyclic Graphs (DAGs) and nonlinear functions. Despite recent progress towards efficient posterior inference over DAGs, existing methods are either limited to variational inference on node permutation matrices for linear causal models, leading to compromised inference accuracy, or continuous relaxation of adjacency matrices constrained by a DAG regularizer, which cannot ensure resulting graphs are DAGs. In this work, we introduce a scalable Bayesian causal discovery framework based on a combination of stochastic gradient Markov Chain Monte Carlo (SG-MCMC) and Variational Inference (VI) that overcomes these limitations. Our approach directly samples DAGs from the posterior without requiring any DAG regularization, simultaneously draws function parameter samples and is applicable to both linear and nonlinear causal models. To enable our approach, we derive a novel equivalence to the permutation-based DAG learning, which opens up possibilities of using any relaxed gradient estimator defined over permutations. To our knowledge, this is the first framework applying gradient-based MCMC sampling for causal discovery. Empirical evaluation on synthetic and real-world datasets demonstrate our approach’s effectiveness compared to state-of-the-art baselines.",
  "problem_description_natural": "The optimization problem involves performing Bayesian inference over the joint space of discrete Directed Acyclic Graphs (DAGs) and continuous parameters of potentially nonlinear structural causal models (SCMs). The goal is to approximate the intractable posterior distribution p(G, Θ | D), where G is a binary adjacency matrix representing a DAG, Θ denotes SCM function parameters, and D is observed data. The challenge stems from the combinatorial explosion of possible DAGs and the non-convex, discontinuous nature of the DAG constraint. The authors reformulate this as inference in an augmented continuous-discrete space (W, p), where W is a binary edge mask and p is a vector of node potentials that implicitly defines a topological ordering. They then establish equivalence between this formulation and permutation-based DAG learning, enabling the use of differentiable relaxations (e.g., Sinkhorn operator) for gradient-based posterior sampling via SG-MCMC and VI.",
  "problem_type": "combinatorial optimization",
  "datasets": [
    "Generated ER Graphs",
    "Generated SF Graphs",
    "SynTReN",
    "Sachs Protein Cells Dataset"
  ],
  "performance_metrics": [
    "Maximum Mean Discrepancy (MMD)",
    "CPDAG Structural Hamming Distance (SHD)",
    "Expected SHD (E-SHD)",
    "Edge F1",
    "Negative Log-Likelihood (NLL)"
  ],
  "lp_model": {
    "objective": "$\\min_{G, \\Theta} \\sum_{n=1}^N \\sum_{i=1}^d \\frac{1}{2\\sigma_i^2} (x_i^{(n)} - f_i(\\boldsymbol{x}^{(n)}_{\\text{Pa}_G^i}; \\Theta))^2 + \\lambda_s \\|G\\|_F^2 + \\frac{1}{2} \\|\\Theta\\|^2$",
    "constraints": [
      "$G_{ij} \\in \\{0,1\\}, \\quad \\forall i,j = 1,\\dots,d$",
      "$G$ must be a Directed Acyclic Graph (DAG), i.e., no directed cycles."
    ],
    "variables": [
      "$G_{ij}$: binary variable indicating presence of directed edge from node $i$ to node $j$",
      "$\\Theta$: continuous parameters of the neural networks defining the functions $f_i$"
    ]
  },
  "raw_latex_model": "$$\\begin{aligned} \\min_{G, \\Theta} \\quad & \\sum_{n=1}^N \\sum_{i=1}^d \\frac{1}{2\\sigma_i^2} (x_i^{(n)} - f_i(\\boldsymbol{x}^{(n)}_{\\text{Pa}_G^i}; \\Theta))^2 + \\lambda_s \\|G\\|_F^2 + \\frac{1}{2} \\|\\Theta\\|^2 \\\\ \\text{s.t.} \\quad & G_{ij} \\in \\{0,1\\}, \\quad \\forall i,j = 1,\\dots,d \\\\ & G \\text{ is a DAG (no directed cycles)} \\end{aligned}$$",
  "algorithm_description": "The paper introduces BayesDAG, a Bayesian causal discovery framework that uses a combination of stochastic gradient Markov Chain Monte Carlo (SG-MCMC) and variational inference (VI) to approximate the posterior distribution over DAGs and model parameters. It reparameterizes the DAG constraint via an augmented space of binary edge masks and node potentials $(\\boldsymbol{W}, \\boldsymbol{p})$, with a mapping $\\tau(\\boldsymbol{W}, \\boldsymbol{p})$ that guarantees acyclicity. SG-MCMC samples $\\boldsymbol{p}$ and $\\boldsymbol{\\Theta}$, while VI approximates the posterior over $\\boldsymbol{W}$ using an independent Bernoulli distribution parameterized by a neural network $\\mu_\\phi(\\boldsymbol{p})$."
}